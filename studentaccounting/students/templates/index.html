<!DOCTYPE html>
<html lang="en" data-theme="business">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.11.1/dist/full.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
      }
    </style>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp,container-queries"></script>
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <title>Student Accounting System</title>
  </head>
  <body>
    <header>
      <div class="flex justify-between p-4 items-center">
        <h1 class="font-poppins text-xl font-bold">Students</h1>
        <label class="input flex items-center gap-2">
          <input
            id="search"
            type="text"
            placeholder="Search"
            class="rounded-xl"
          />
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 16 16"
            fill="currentColor"
            class="w-4 h-4 opacity-70"
          >
            <path
              fill-rule="evenodd"
              d="M9.965 11.026a5 5 0 1 1 1.06-1.06l2.755 2.754a.75.75 0 1 1-1.06 1.06l-2.755-2.754ZM10.5 7a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Z"
              clip-rule="evenodd"
            />
          </svg>
        </label>
        <button
          class="btn btn-primary rounded-2xl text-white"
          onclick="add_student_modal.showModal()"
        >
          New student
        </button>
      </div>
    </header>
    <main>
      <div class="overflow-x-auto">
        <table class="table">
          <!-- head -->
          <thead>
            <tr>
              <th>Name</th>
              <th>Course</th>
              <th>Email Address</th>
              <th>Gender</th>
              <th>Subjects</th>
            </tr>
          </thead>
          <tbody>
            {% for student in students%}
            <tr>
              <td>
                <div class="flex items-center gap-3">
                  <div class="avatar">
                    <div class="mask mask-squircle w-12 h-12">
                      <img
                        src="{{student.image.url}}"
                        alt="Avatar Tailwind CSS Component"
                      />
                    </div>
                  </div>
                  <div>
                    <div class="font-bold font-poppins">{{student}}</div>
                    <div class="text-sm opacity-50">{{student.id_number}}</div>
                  </div>
                </div>
              </td>
              <td>
                {{student.course_name}}
                <br />
                {% if student.year_level == 1 %}
                <span class="badge badge-ghost badge-sm">1st year</span>
                {% elif student.year_level == 2 %}
                <span class="badge badge-ghost badge-sm">2nd year</span>
                {% elif student.year_level == 3 %}
                <span class="badge badge-ghost badge-sm">3rd year</span>
                {% elif student.year_level == 4 %}
                <span class="badge badge-ghost badge-sm">4th year</span>
                {% endif %}
              </td>
              <td>{{student.email_address}}</td>
              <td>{{student.gender}}</td>
              <td>{{student.subjects}}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </main>
    <dialog id="add_student_modal" class="modal">
      <div class="modal-box">
        <h3 class="font-bold text-lg">Add student</h3>
        <p class="py-4">
          Fill in the student details below and click "Close" to cancel
        </p>
        <div class="modal-action">
          <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="grid grid-cols-2 gap-2">
              <label
                class="input flex items-center gap-2 w-full"
                for="id_number"
              >
                <input
                  id="id_number"
                  name="id_number"
                  maxlength="6"
                  oninput="this.value = this.value.replace(/[^0-9]/g, '')"
                  type="text"
                  placeholder="ID Number"
                  class="rounded-xl w-full"
                />
              </label>
              <label
                class="input flex items-center gap-2 w-full"
                for="first_name"
              >
                <input
                  id="first_name"
                  name="first_name"
                  type="text"
                  oninput="this.value = this.value.replace(/[^a-zA-Z\s]/g, '')"
                  placeholder="First Name"
                  class="rounded-xl w-full"
                />
              </label>
              <label
                class="input flex items-center gap-2 w-full"
                for="middle_initial"
              >
                <input
                  id="middle_initial"
                  name="middle_initial"
                  maxlength="1"
                  type="text"
                  oninput="this.value = this.value.replace(/[^a-zA-Z\s]/g, '')"
                  placeholder="Middle Initial"
                  class="rounded-xl w-full"
                />
              </label>
              <label
                class="input flex items-center gap-2 w-full"
                for="last_name"
              >
                <input
                  id="last_name"
                  name="last_name"
                  type="text"
                  oninput="this.value = this.value.replace(/[^a-zA-Z\s]/g, '')"
                  placeholder="Last Name"
                  class="rounded-xl w-full"
                />
              </label>
              <label
                class="input flex items-center gap-2 w-full"
                for="email_address"
              >
                <input
                  id="email_address"
                  name="email_address"
                  type="text"
                  placeholder="Email Address"
                  class="rounded-xl w-full"
                />
              </label>
              <label class="input flex items-center gap-2 w-full" for="gender">
                <select
                  class="select select-bordered rounded-xl w-full max-w-xs"
                  name="gender"
                  id="gender"
                >
                  <option disabled selected>Gender</option>
                  <option>Male</option>
                  <option>Female</option>
                  <option>Other</option>
                </select>
              </label>
              <label
                class="input flex items-center gap-2 w-full"
                for="course_name"
              >
                <select
                  class="select select-bordered rounded-xl w-full max-w-xs"
                  name="course_name"
                  id="course_name"
                >
                  <option disabled selected>Select a Course</option>
                  <option>
                    Bachelor of Science in Civil Engineering (BSCE)
                  </option>
                  <option>
                    Bachelor of Science in Computer Engineering (BSCpE)
                  </option>
                  <option>
                    Bachelor of Science in Electrical Engineering (BSEE)
                  </option>
                  <option>
                    Bachelor of Science in Electronics Engineering (BSEcE)
                  </option>
                  <option>
                    Bachelor of Science in Industrial Engineering (BSIE)
                  </option>
                  <option>
                    Bachelor of Science in Mechanical Engineering (BSME)
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Automotive Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) - Civil
                    Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Cosmetology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Drafting Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Electrical Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Electronics Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) - Food
                    Preparation and Services Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Furniture and Cabinet Making
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Garments Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Interior Design Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Machine Shop Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) - Power
                    Plant Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Refrigeration and Air-conditioning Technology
                  </option>
                  <option>
                    Bachelor of Science in Industrial Technology (BSIT) -
                    Welding and Fabrication Technology
                  </option>
                  <option>
                    Bachelor of Arts in Communication (AB Communication)
                  </option>
                  <option>
                    Bachelor of Science in Business Administration (BSBA) -
                    Human Resource Management
                  </option>
                  <option>
                    Bachelor of Science in Business Administration (BSBA) -
                    Marketing Management
                  </option>
                  <option>
                    Bachelor of Science in Information Technology (BSIT)
                  </option>
                  <option>Bachelor of Science in Criminology (BSCrim)</option>
                  <option>Bachelor of Science in Psychology (BSPsych)</option>
                  <option>Bachelor of Elementary Education (BEEd)</option>
                  <option>
                    Bachelor of Secondary Education (BSE) - Biological Sciences
                  </option>
                  <option>
                    Bachelor of Secondary Education (BSE) - English
                  </option>
                  <option>
                    Bachelor of Secondary Education (BSE) - Mathematics
                  </option>
                  <option>
                    Bachelor of Secondary Education (BSE) - Physical Sciences
                  </option>
                  <option>
                    Bachelor of Secondary Education (BSE) - Social Sciences
                  </option>
                  <option>
                    Bachelor of Science in Marine Transportation (BSMT)
                  </option>
                  <option>
                    Bachelor of Science in Marine Engineering (BSMarE)
                  </option>
                </select>
              </label>
              <label
                class="input flex items-center gap-2 w-full"
                for="year_level"
              >
                <select
                  class="select select-bordered rounded-xl w-full max-w-xs"
                  name="year_level"
                  id="year_level"
                >
                  <option disabled selected>Year level</option>
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                </select>
              </label>
              <label
                class="input flex items-center gap-2 w-full"
                for="subjects"
              >
                <input
                  id="subjects"
                  name="subjects"
                  type="text"
                  max="15"
                  maxlength="2"
                  min="0"
                  placeholder="Number of subjects"
                  class="rounded-xl w-full"
                />
              </label>
            </div>
            <label
              class="input flex items-center gap-2 w-full mt-4"
              for="image"
            >
              <input
                type="file"
                id="image"
                name="image"
                accept="image/png, image/gif, image/jpeg, image/jpg, image/bmp, image/webp"
                class="file-input file-input-bordered file-input-sm rounded-xl w-full max-w-xs file-input-primary"
              />
            </label>
            <div class="flex justify-end gap-x-4">
              <button
                type="button"
                class="btn rounded-xl"
                onclick="add_student_modal.close()"
              >
                Close
              </button>
              <button class="btn btn-primary rounded-xl" type="submit">
                Add student
              </button>
            </div>
            {% if error_messages %}
            <p class="text-red-400 mx-4 flex justify-center mt-2">
              {{ error_messages }}
            </p>
            {% endif %}
          </form>
        </div>
      </div>
    </dialog>
  </body>
  <script>
    $(document).ready(function () {
      $("#search").on("input", function () {
        var searchQuery = $(this).val().trim();
        if (searchQuery !== "") {
          performSearch(searchQuery);
        } else {
          location.reload();
        }
      });

      function performSearch(query) {
        var url = "/students/?search=" + encodeURIComponent(query);
        $.get(url, function (data) {
          $("tbody").html(data);
        }).fail(function (jqXHR, textStatus, errorThrown) {
          console.error("Error performing search:", textStatus, errorThrown);
        });
      }
    });
  </script>
</html>
